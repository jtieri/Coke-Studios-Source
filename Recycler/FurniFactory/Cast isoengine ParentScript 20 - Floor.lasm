property iShapeSprite, aTileSprites, aPatterns, sCastLib
global oIsoScene

on new me
  [  0] getparam 0 .............................. <me>
  [  2] getparam 0 .............................. <me>
  [  4] pusharglist 1 ........................... <me>
  [  6] objcall 925 ............................. <me.loadPatterns()>
  [  9] setobjprop 930 .......................... me.aPatterns = me.loadPatterns()
  [ 12] getparam 0 .............................. <me>
  [ 14] pusharglist 0 ........................... <>
  [ 16] extcall 130 ............................. <VOID>
  [ 18] setobjprop 931 .......................... me.iShapeSprite = VOID
  [ 21] getparam 0 .............................. <me>
  [ 23] pusharglist 0 ........................... <[]>
  [ 25] pushlist ................................ <[]>
  [ 26] setobjprop 932 .......................... me.aTileSprites = []
  [ 29] getparam 0 .............................. <me>
  [ 31] pushcons 0 .............................. <"Studio">
  [ 33] setobjprop 253 .......................... me.sCastLib = "Studio"
  [ 35] getparam 0 .............................. <me>
  [ 37] pusharglistnoret 1 ...................... <me>
  [ 39] extcall 92 .............................. return me
  [ 41] ret
end

on init me, oXml
  [  0] getparam 1 .............................. <oXml>
  [  2] pusharglist 1 ........................... <oXml>
  [  4] extcall 105 ............................. <voidp(oXml)>
  [  6] jmpifz [ 13] ............................ if voidp(oXml) then
  [  9] pusharglistnoret 0 ...................... <>
  [ 11] extcall 92 .............................. return 
  [ 13] getparam 1 .............................. <oXml>
  [ 15] pushcons 1 .............................. <"Shape">
  [ 17] pusharglist 2 ........................... <oXml, "Shape">
  [ 19] extcall 156 ............................. <getNode(oXml, "Shape")>
  [ 21] setlocal 0 .............................. oShapeNode = getNode(oXml, "Shape")
  [ 23] getlocal 0 .............................. <oShapeNode>
  [ 25] pusharglist 1 ........................... <oShapeNode>
  [ 27] extcall 105 ............................. <voidp(oShapeNode)>
  [ 29] not ..................................... <not voidp(oShapeNode)>
  [ 30] jmpifz [ 55] ............................ if not voidp(oShapeNode) then
  [ 33] getglobal 88 ............................ <oIsoScene>
  [ 35] getchainedprop 113 ...................... <oIsoScene.oSpriteManager>
  [ 37] getlocal 0 .............................. <oShapeNode>
  [ 39] pusharglist 2 ........................... <oIsoScene.oSpriteManager, oShapeNode>
  [ 41] objcall 589 ............................. <oIsoScene.oSpriteManager.buildSpriteProps(oShapeNode)>
  [ 44] setlocal 1 .............................. aProps = oIsoScene.oSpriteManager.buildSpriteProps(oShapeNode)
  [ 46] getparam 0 .............................. <me>
  [ 48] getlocal 1 .............................. <aProps>
  [ 50] pusharglistnoret 2 ...................... <me, aProps>
  [ 52] objcall 922 ............................. me.drawFloorShape(aProps)
  [ 55] getparam 1 .............................. <oXml>
  [ 57] pushcons 2 .............................. <"FloorTiles">
  [ 59] pusharglist 2 ........................... <oXml, "FloorTiles">
  [ 61] extcall 156 ............................. <getNode(oXml, "FloorTiles")>
  [ 63] setlocal 2 .............................. oFloorTiles = getNode(oXml, "FloorTiles")
  [ 65] getlocal 2 .............................. <oFloorTiles>
  [ 67] pusharglist 1 ........................... <oFloorTiles>
  [ 69] extcall 105 ............................. <voidp(oFloorTiles)>
  [ 71] not ..................................... <not voidp(oFloorTiles)>
  [ 72] jmpifz [230] ............................ if not voidp(oFloorTiles) then
  [ 75] getglobal 88 ............................ <oIsoScene>
  [ 77] getchainedprop 113 ...................... <oIsoScene.oSpriteManager>
  [ 79] getlocal 2 .............................. <oFloorTiles>
  [ 81] pusharglist 2 ........................... <oIsoScene.oSpriteManager, oFloorTiles>
  [ 83] objcall 589 ............................. <oIsoScene.oSpriteManager.buildSpriteProps(oFloorTiles)>
  [ 86] setlocal 1 .............................. aProps = oIsoScene.oSpriteManager.buildSpriteProps(oFloorTiles)
  [ 88] getlocal 2 .............................. <oFloorTiles>
  [ 90] pushcons 3 .............................. <"FloorTile">
  [ 92] pusharglist 2 ........................... <oFloorTiles, "FloorTile">
  [ 94] extcall 921 ............................. <getNodes(oFloorTiles, "FloorTile")>
  [ 97] setlocal 3 .............................. aFloorTiles = getNodes(oFloorTiles, "FloorTile")
  [ 99] getlocal 3 .............................. <aFloorTiles>
  [101] getobjprop 169 .......................... <aFloorTiles.count>
  [103] setlocal 4
  [105] getlocal 4
  [107] pushint8 1 .............................. <1>
  [109] gteq
  [110] jmpifz [230] ............................ repeat with i = aFloorTiles.count down to 1
  [113] getlocal 3 .............................. <aFloorTiles>
  [115] getlocal 4 .............................. <i>
  [117] pusharglist 2 ........................... <aFloorTiles, i>
  [119] objcall 196 ............................. <aFloorTiles[i]>
  [121] setlocal 5 .............................. oFloorTile = aFloorTiles[i]
  [123] getlocal 5 .............................. <oFloorTile>
  [125] pusharglist 1 ........................... <oFloorTile>
  [127] objcall 405 ............................. <oFloorTile.toString()>
  [130] setlocal 6 .............................. sFloorTile = oFloorTile.toString()
  [132] getlocal 5 .............................. <oFloorTile>
  [134] getchainedprop 108 ...................... <oFloorTile.attributes>
  [136] getobjprop 612 .......................... <oFloorTile.attributes.row>
  [139] pusharglist 1 ........................... <oFloorTile.attributes.row>
  [141] extcall 107 ............................. <integer(oFloorTile.attributes.row)>
  [143] setlocal 7 .............................. iRow = integer(oFloorTile.attributes.row)
  [145] getlocal 5 .............................. <oFloorTile>
  [147] getchainedprop 108 ...................... <oFloorTile.attributes>
  [149] getobjprop 613 .......................... <oFloorTile.attributes.col>
  [152] pusharglist 1 ........................... <oFloorTile.attributes.col>
  [154] extcall 107 ............................. <integer(oFloorTile.attributes.col)>
  [156] setlocal 8 .............................. iCol = integer(oFloorTile.attributes.col)
  [158] pushzero ................................ <0>
  [159] setlocal 9 .............................. iXOff = 0
  [161] pushzero ................................ <0>
  [162] setlocal 10 ............................. iYOff = 0
  [164] getlocal 6 .............................. <sFloorTile>
  [166] pushcons 4 .............................. <"xoff=">
  [168] containsstr ............................. <sFloorTile contains "xoff=">
  [169] jmpifz [184] ............................ if sFloorTile contains "xoff=" then
  [172] getlocal 5 .............................. <oFloorTile>
  [174] getchainedprop 108 ...................... <oFloorTile.attributes>
  [176] getobjprop 111 .......................... <oFloorTile.attributes.xoff>
  [178] pusharglist 1 ........................... <oFloorTile.attributes.xoff>
  [180] extcall 107 ............................. <integer(oFloorTile.attributes.xoff)>
  [182] setlocal 9 .............................. iXOff = integer(oFloorTile.attributes.xoff)
  [184] getlocal 6 .............................. <sFloorTile>
  [186] pushcons 5 .............................. <"yoff=">
  [188] containsstr ............................. <sFloorTile contains "yoff=">
  [189] jmpifz [204] ............................ if sFloorTile contains "yoff=" then
  [192] getlocal 5 .............................. <oFloorTile>
  [194] getchainedprop 108 ...................... <oFloorTile.attributes>
  [196] getobjprop 112 .......................... <oFloorTile.attributes.yoff>
  [198] pusharglist 1 ........................... <oFloorTile.attributes.yoff>
  [200] extcall 107 ............................. <integer(oFloorTile.attributes.yoff)>
  [202] setlocal 10 ............................. iYOff = integer(oFloorTile.attributes.yoff)
  [204] getparam 0 .............................. <me>
  [206] getlocal 7 .............................. <iRow>
  [208] getlocal 8 .............................. <iCol>
  [210] getlocal 1 .............................. <aProps>
  [212] getlocal 9 .............................. <iXOff>
  [214] getlocal 10 ............................. <iYOff>
  [216] pusharglistnoret 6 ...................... <me, iRow, iCol, aProps, iXOff, iYOff>
  [218] objcall 923 ............................. me.drawFloortile(iRow, iCol, aProps, iXOff, iYOff)
  [221] pushint8 -1
  [223] getlocal 4
  [225] add
  [226] setlocal 4
  [228] endrepeat [105]
  [230] ret
end

on drawFloorShape me, aProps
  [  0] getglobal 88 ............................ <oIsoScene>
  [  2] getchainedprop 113 ...................... <oIsoScene.oSpriteManager>
  [  4] getparam 1 .............................. <aProps>
  [  6] pusharglist 2 ........................... <oIsoScene.oSpriteManager, aProps>
  [  8] objcall 588 ............................. <oIsoScene.oSpriteManager.drawStaticSceneSprite(aProps)>
  [ 11] setlocal 0 .............................. iSprite = oIsoScene.oSpriteManager.drawStaticSceneSprite(aProps)
  [ 13] getlocal 0 .............................. <iSprite>
  [ 15] pusharglist 1 ........................... <iSprite>
  [ 17] extcall 451 ............................. <sprite(iSprite)>
  [ 20] getlocal 0 .............................. <iSprite>
  [ 22] pusharglist 1 ........................... <iSprite>
  [ 24] extcall 451 ............................. <sprite(iSprite)>
  [ 27] getobjprop 299 .......................... <sprite(iSprite).locH>
  [ 30] pushint8 1 .............................. <1>
  [ 32] sub ..................................... <sprite(iSprite).locH - 1>
  [ 33] setobjprop 299 .......................... sprite(iSprite).locH = sprite(iSprite).locH - 1
  [ 36] getlocal 0 .............................. <iSprite>
  [ 38] pusharglist 1 ........................... <iSprite>
  [ 40] extcall 451 ............................. <sprite(iSprite)>
  [ 43] getlocal 0 .............................. <iSprite>
  [ 45] pusharglist 1 ........................... <iSprite>
  [ 47] extcall 451 ............................. <sprite(iSprite)>
  [ 50] getobjprop 300 .......................... <sprite(iSprite).locV>
  [ 53] pushint8 2 .............................. <2>
  [ 55] sub ..................................... <sprite(iSprite).locV - 2>
  [ 56] setobjprop 300 .......................... sprite(iSprite).locV = sprite(iSprite).locV - 2
  [ 59] getparam 0 .............................. <me>
  [ 61] getlocal 0 .............................. <iSprite>
  [ 63] setobjprop 931 .......................... me.iShapeSprite = iSprite
  [ 66] getparam 0 .............................. <me>
  [ 68] pushint8 1 .............................. <1>
  [ 70] pushint8 1 .............................. <1>
  [ 72] getparam 0 .............................. <me>
  [ 74] getobjprop 931 .......................... <me.iShapeSprite>
  [ 77] pusharglistnoret 4 ...................... <me, 1, 1, me.iShapeSprite>
  [ 79] objcall 926 ............................. me.setPattern(1, 1, me.iShapeSprite)
  [ 82] ret
end

on drawFloortile me, iRow, iCol, aProps, iXOff, iYOff
  [  0] getglobal 88 ............................ <oIsoScene>
  [  2] getchainedprop 114 ...................... <oIsoScene.oGrid>
  [  4] getparam 1 .............................. <iRow>
  [  6] getparam 2 .............................. <iCol>
  [  8] pusharglist 3 ........................... <oIsoScene.oGrid, iRow, iCol>
  [ 10] objcall 283 ............................. <oIsoScene.oGrid.getSquareByRowCol(iRow, iCol)>
  [ 13] setlocal 0 .............................. oSquare = oIsoScene.oGrid.getSquareByRowCol(iRow, iCol)
  [ 15] getlocal 0 .............................. <oSquare>
  [ 17] getchainedprop 313 ...................... <oSquare.oViewPoints>
  [ 20] getobjprop 311 .......................... <oSquare.oViewPoints.bl>
  [ 23] setlocal 1 .............................. oLoc = oSquare.oViewPoints.bl
  [ 25] getparam 3 .............................. <aProps>
  [ 27] pushsymb 144 ............................ <#x>
  [ 29] getlocal 1 .............................. <oLoc>
  [ 31] getobjprop 299 .......................... <oLoc.locH>
  [ 34] pusharglistnoret 3 ...................... <aProps, #x, oLoc.locH>
  [ 36] objcall 861 ............................. aProps[#x] = oLoc.locH
  [ 39] getparam 3 .............................. <aProps>
  [ 41] pushsymb 315 ............................ <#y>
  [ 44] getlocal 1 .............................. <oLoc>
  [ 46] getobjprop 300 .......................... <oLoc.locV>
  [ 49] pusharglistnoret 3 ...................... <aProps, #y, oLoc.locV>
  [ 51] objcall 861 ............................. aProps[#y] = oLoc.locV
  [ 54] getglobal 88 ............................ <oIsoScene>
  [ 56] getchainedprop 113 ...................... <oIsoScene.oSpriteManager>
  [ 58] getparam 3 .............................. <aProps>
  [ 60] pusharglist 2 ........................... <oIsoScene.oSpriteManager, aProps>
  [ 62] objcall 588 ............................. <oIsoScene.oSpriteManager.drawStaticSceneSprite(aProps)>
  [ 65] setlocal 2 .............................. iSprite = oIsoScene.oSpriteManager.drawStaticSceneSprite(aProps)
  [ 67] getparam 4 .............................. <iXOff>
  [ 69] pusharglist 1 ........................... <iXOff>
  [ 71] extcall 105 ............................. <voidp(iXOff)>
  [ 73] not ..................................... <not voidp(iXOff)>
  [ 74] jmpifz [100] ............................ if not voidp(iXOff) then
  [ 77] getlocal 2 .............................. <iSprite>
  [ 79] pusharglist 1 ........................... <iSprite>
  [ 81] extcall 451 ............................. <sprite(iSprite)>
  [ 84] getlocal 2 .............................. <iSprite>
  [ 86] pusharglist 1 ........................... <iSprite>
  [ 88] extcall 451 ............................. <sprite(iSprite)>
  [ 91] getobjprop 299 .......................... <sprite(iSprite).locH>
  [ 94] getparam 4 .............................. <iXOff>
  [ 96] add ..................................... <sprite(iSprite).locH + iXOff>
  [ 97] setobjprop 299 .......................... sprite(iSprite).locH = sprite(iSprite).locH + iXOff
  [100] getparam 5 .............................. <iYOff>
  [102] pusharglist 1 ........................... <iYOff>
  [104] extcall 105 ............................. <voidp(iYOff)>
  [106] not ..................................... <not voidp(iYOff)>
  [107] jmpifz [133] ............................ if not voidp(iYOff) then
  [110] getlocal 2 .............................. <iSprite>
  [112] pusharglist 1 ........................... <iSprite>
  [114] extcall 451 ............................. <sprite(iSprite)>
  [117] getlocal 2 .............................. <iSprite>
  [119] pusharglist 1 ........................... <iSprite>
  [121] extcall 451 ............................. <sprite(iSprite)>
  [124] getobjprop 300 .......................... <sprite(iSprite).locV>
  [127] getparam 5 .............................. <iYOff>
  [129] add ..................................... <sprite(iSprite).locV + iYOff>
  [130] setobjprop 300 .......................... sprite(iSprite).locV = sprite(iSprite).locV + iYOff
  [133] getlocal 2 .............................. <iSprite>
  [135] pusharglist 1 ........................... <iSprite>
  [137] extcall 451 ............................. <sprite(iSprite)>
  [140] getlocal 2 .............................. <iSprite>
  [142] pusharglist 1 ........................... <iSprite>
  [144] extcall 451 ............................. <sprite(iSprite)>
  [147] getobjprop 299 .......................... <sprite(iSprite).locH>
  [150] pushzero ................................ <0>
  [151] sub ..................................... <sprite(iSprite).locH - 0>
  [152] setobjprop 299 .......................... sprite(iSprite).locH = sprite(iSprite).locH - 0
  [155] getlocal 2 .............................. <iSprite>
  [157] pusharglist 1 ........................... <iSprite>
  [159] extcall 451 ............................. <sprite(iSprite)>
  [162] getlocal 2 .............................. <iSprite>
  [164] pusharglist 1 ........................... <iSprite>
  [166] extcall 451 ............................. <sprite(iSprite)>
  [169] getobjprop 300 .......................... <sprite(iSprite).locV>
  [172] pushzero ................................ <0>
  [173] sub ..................................... <sprite(iSprite).locV - 0>
  [174] setobjprop 300 .......................... sprite(iSprite).locV = sprite(iSprite).locV - 0
  [177] getparam 0 .............................. <me>
  [179] getchainedprop 932 ...................... <me.aTileSprites>
  [182] getlocal 2 .............................. <iSprite>
  [184] pusharglistnoret 2 ...................... <me.aTileSprites, iSprite>
  [186] objcall 133 ............................. me.aTileSprites.add(iSprite)
  [188] getparam 0 .............................. <me>
  [190] pushint8 1 .............................. <1>
  [192] pushint8 1 .............................. <1>
  [194] getlocal 2 .............................. <iSprite>
  [196] pusharglistnoret 4 ...................... <me, 1, 1, iSprite>
  [198] objcall 926 ............................. me.setPattern(1, 1, iSprite)
  [201] ret
end

on mouseDownEvent me, iSprite, oSprite
  [  0] ret
end

on mouseIsOverFloor me
  [  0] pushzero ................................ <0>
  [  1] setlocal 0 .............................. bRollover = 0
  [  3] pushint8 1 .............................. <1>
  [  5] setlocal 1
  [  7] getlocal 1
  [  9] getparam 0 .............................. <me>
  [ 11] pushsymb 932 ............................ <#aTileSprites>
  [ 14] pusharglist 2 ........................... <me, #aTileSprites>
  [ 16] objcall 169 ............................. <me.aTileSprites.count>
  [ 18] lteq
  [ 19] jmpifz [ 58] ............................ repeat with i = 1 to me.aTileSprites.count
  [ 22] getparam 0 .............................. <me>
  [ 24] pushsymb 932 ............................ <#aTileSprites>
  [ 27] getlocal 1 .............................. <i>
  [ 29] pusharglist 3 ........................... <me, #aTileSprites, i>
  [ 31] objcall 577 ............................. <me.aTileSprites[i]>
  [ 34] pusharglist 1 ........................... <me.aTileSprites[i]>
  [ 36] extcall 757 ............................. <rollover(me.aTileSprites[i])>
  [ 39] jmpifz [ 49] ............................ if rollover(me.aTileSprites[i]) then
  [ 42] pushint8 1 .............................. <1>
  [ 44] setlocal 0 .............................. bRollover = 1
  [ 46] jmp [ 58] ............................... exit repeat
  [ 49] pushint8 1
  [ 51] getlocal 1
  [ 53] add
  [ 54] setlocal 1
  [ 56] endrepeat [  7]
  [ 58] getlocal 0 .............................. <bRollover>
  [ 60] pusharglistnoret 1 ...................... <bRollover>
  [ 62] extcall 92 .............................. return bRollover
  [ 64] ret
end

on destroy me
  [  0] getglobal 88 ............................ <oIsoScene>
  [  2] getchainedprop 113 ...................... <oIsoScene.oSpriteManager>
  [  4] getparam 0 .............................. <me>
  [  6] getobjprop 931 .......................... <me.iShapeSprite>
  [  9] pusharglistnoret 2 ...................... <oIsoScene.oSpriteManager, me.iShapeSprite>
  [ 11] objcall 506 ............................. oIsoScene.oSpriteManager.returnPooledSprite(me.iShapeSprite)
  [ 14] getglobal 88 ............................ <oIsoScene>
  [ 16] getchainedprop 113 ...................... <oIsoScene.oSpriteManager>
  [ 18] getparam 0 .............................. <me>
  [ 20] getobjprop 932 .......................... <me.aTileSprites>
  [ 23] pusharglistnoret 2 ...................... <oIsoScene.oSpriteManager, me.aTileSprites>
  [ 25] objcall 586 ............................. oIsoScene.oSpriteManager.returnPooledSprites(me.aTileSprites)
  [ 28] getparam 0 .............................. <me>
  [ 30] pusharglist 0 ........................... <[]>
  [ 32] pushlist ................................ <[]>
  [ 33] setobjprop 932 .......................... me.aTileSprites = []
  [ 36] getparam 0 .............................. <me>
  [ 38] pusharglist 0 ........................... <>
  [ 40] extcall 130 ............................. <VOID>
  [ 42] setobjprop 931 .......................... me.iShapeSprite = VOID
  [ 45] ret
end

on toggleDisplay me
  [  0] getparam 0 .............................. <me>
  [  2] getobjprop 932 .......................... <me.aTileSprites>
  [  5] peek 0
  [  7] pusharglist 1
  [  9] extcall 169
  [ 11] pushint8 1
  [ 13] peek 0
  [ 15] peek 2
  [ 17] lteq
  [ 18] jmpifz [ 79] ............................ repeat with i in me.aTileSprites
  [ 21] peek 2
  [ 23] peek 1
  [ 25] pusharglist 2
  [ 27] extcall 196
  [ 29] setlocal 0
  [ 31] pusharglist 0 ........................... <>
  [ 33] thebuiltin 239 .......................... <the optionDown>
  [ 35] jmpifz [ 53] ............................ if the optionDown then
  [ 38] getlocal 0 .............................. <i>
  [ 40] pusharglist 1 ........................... <i>
  [ 42] extcall 451 ............................. <sprite(i)>
  [ 45] pushint8 1 .............................. <1>
  [ 47] setobjprop 464 .......................... sprite(i).visible = 1
  [ 50] jmp [ 74] ............................... next repeat
  [ 53] getlocal 0 .............................. <i>
  [ 55] pusharglist 1 ........................... <i>
  [ 57] extcall 451 ............................. <sprite(i)>
  [ 60] getlocal 0 .............................. <i>
  [ 62] pusharglist 1 ........................... <i>
  [ 64] extcall 451 ............................. <sprite(i)>
  [ 67] getobjprop 464 .......................... <sprite(i).visible>
  [ 70] not ..................................... <not sprite(i).visible>
  [ 71] setobjprop 464 .......................... sprite(i).visible = not sprite(i).visible
  [ 74] pushint8 1
  [ 76] add
  [ 77] endrepeat [ 13]
  [ 79] pop 3
  [ 81] getparam 0 .............................. <me>
  [ 83] getobjprop 931 .......................... <me.iShapeSprite>
  [ 86] pusharglist 1 ........................... <me.iShapeSprite>
  [ 88] extcall 105 ............................. <voidp(me.iShapeSprite)>
  [ 90] not ..................................... <not voidp(me.iShapeSprite)>
  [ 91] jmpifz [121] ............................ if not voidp(me.iShapeSprite) then
  [ 94] getparam 0 .............................. <me>
  [ 96] getobjprop 931 .......................... <me.iShapeSprite>
  [ 99] pusharglist 1 ........................... <me.iShapeSprite>
  [101] extcall 451 ............................. <sprite(me.iShapeSprite)>
  [104] getparam 0 .............................. <me>
  [106] getobjprop 931 .......................... <me.iShapeSprite>
  [109] pusharglist 1 ........................... <me.iShapeSprite>
  [111] extcall 451 ............................. <sprite(me.iShapeSprite)>
  [114] getobjprop 464 .......................... <sprite(me.iShapeSprite).visible>
  [117] not ..................................... <not sprite(me.iShapeSprite).visible>
  [118] setobjprop 464 .......................... sprite(me.iShapeSprite).visible = not sprite(me.iShapeSprite).visible
  [121] ret
end

on loadPatterns me
  [  0] pusharglist 0 ........................... <[:]>
  [  2] pushproplist ............................ <[:]>
  [  3] setlocal 0 .............................. aFloorPatterns = [:]
  [  5] pushcons 6 .............................. <"floorpattern_patterns_index">
  [  7] getparam 0 .............................. <me>
  [  9] getobjprop 253 .......................... <me.sCastLib>
  [ 11] pusharglist 2 ........................... <"floorpattern_patterns_index", me.sCastLib>
  [ 13] extcall 454 ............................. <member("floorpattern_patterns_index", me.sCastLib)>
  [ 16] setlocal 1 .............................. oPatternMember = member("floorpattern_patterns_index", me.sCastLib)
  [ 18] getlocal 1 .............................. <oPatternMember>
  [ 20] getobjprop 606 .......................... <oPatternMember.memberNum>
  [ 23] pushint8 1 .............................. <1>
  [ 25] inv ..................................... <-1>
  [ 26] eq ...................................... <oPatternMember.memberNum = -1>
  [ 27] jmpifz [ 36] ............................ if oPatternMember.memberNum = -1 then
  [ 30] getlocal 0 .............................. <aFloorPatterns>
  [ 32] pusharglistnoret 1 ...................... <aFloorPatterns>
  [ 34] extcall 92 .............................. return aFloorPatterns
  [ 36] getlocal 1 .............................. <oPatternMember>
  [ 38] getobjprop 497 .......................... <oPatternMember.text>
  [ 41] setlocal 2 .............................. sPatternText = oPatternMember.text
  [ 43] pushint8 1 .............................. <1>
  [ 45] setlocal 3
  [ 47] getlocal 3
  [ 49] getlocal 2 .............................. <sPatternText>
  [ 51] pushsymb 939 ............................ <#lines>
  [ 54] pusharglist 2 ........................... <sPatternText, #lines>
  [ 56] objcall 169 ............................. <sPatternText.lines.count>
  [ 58] lteq
  [ 59] jmpifz [215] ............................ repeat with i = 1 to sPatternText.lines.count
  [ 62] getlocal 2 .............................. <sPatternText>
  [ 64] pushsymb 940 ............................ <#line>
  [ 67] getlocal 3 .............................. <i>
  [ 69] pusharglist 3 ........................... <sPatternText, #line, i>
  [ 71] objcall 577 ............................. <sPatternText.line[i]>
  [ 74] setlocal 4 .............................. sPatternLine = sPatternText.line[i]
  [ 76] getlocal 4 .............................. <sPatternLine>
  [ 78] pusharglist 1 ........................... <sPatternLine>
  [ 80] extcall 941 ............................. <value(sPatternLine)>
  [ 83] setlocal 5 .............................. aPatternList = value(sPatternLine)
  [ 85] getlocal 5 .............................. <aPatternList>
  [ 87] getobjprop 625 .......................... <aPatternList.name>
  [ 90] setlocal 6 .............................. sPatternName = aPatternList.name
  [ 92] getlocal 5 .............................. <aPatternList>
  [ 94] getobjprop 942 .......................... <aPatternList.field>
  [ 97] setlocal 7 .............................. sColorField = aPatternList.field
  [ 99] pusharglist 0 ........................... <[]>
  [101] pushlist ................................ <[]>
  [102] setlocal 8 .............................. aColors = []
  [104] getlocal 7 .............................. <sColorField>
  [106] getparam 0 .............................. <me>
  [108] getobjprop 253 .......................... <me.sCastLib>
  [110] pusharglist 2 ........................... <sColorField, me.sCastLib>
  [112] extcall 454 ............................. <member(sColorField, me.sCastLib)>
  [115] setlocal 9 .............................. oColorsMember = member(sColorField, me.sCastLib)
  [117] getlocal 9 .............................. <oColorsMember>
  [119] getobjprop 497 .......................... <oColorsMember.text>
  [122] setlocal 10 ............................. sColorsText = oColorsMember.text
  [124] pushint8 1 .............................. <1>
  [126] setlocal 11
  [128] getlocal 11
  [130] getlocal 10 ............................. <sColorsText>
  [132] pushsymb 939 ............................ <#lines>
  [135] pusharglist 2 ........................... <sColorsText, #lines>
  [137] objcall 169 ............................. <sColorsText.lines.count>
  [139] lteq
  [140] jmpifz [183] ............................ repeat with ii = 1 to sColorsText.lines.count
  [143] getlocal 10 ............................. <sColorsText>
  [145] pushsymb 940 ............................ <#line>
  [148] getlocal 11 ............................. <ii>
  [150] pusharglist 3 ........................... <sColorsText, #line, ii>
  [152] objcall 577 ............................. <sColorsText.line[ii]>
  [155] setlocal 12 ............................. sColorLine = sColorsText.line[ii]
  [157] getlocal 12 ............................. <sColorLine>
  [159] pusharglist 1 ........................... <sColorLine>
  [161] extcall 941 ............................. <value(sColorLine)>
  [164] setlocal 13 ............................. aColorsList = value(sColorLine)
  [166] getlocal 8 .............................. <aColors>
  [168] getlocal 13 ............................. <aColorsList>
  [170] pusharglistnoret 2 ...................... <aColors, aColorsList>
  [172] objcall 133 ............................. aColors.add(aColorsList)
  [174] pushint8 1
  [176] getlocal 11
  [178] add
  [179] setlocal 11
  [181] endrepeat [128]
  [183] getlocal 8 .............................. <aColors>
  [185] pusharglist 1 ........................... <aColors>
  [187] extcall 105 ............................. <voidp(aColors)>
  [189] jmpifz [195] ............................ if voidp(aColors) then
  [192] jmp [206] ............................... next repeat
  [195] getlocal 0 .............................. <aFloorPatterns>
  [197] getlocal 6 .............................. <sPatternName>
  [199] getlocal 8 .............................. <aColors>
  [201] pusharglistnoret 3 ...................... <aFloorPatterns, sPatternName, aColors>
  [203] objcall 357 ............................. aFloorPatterns.addProp(sPatternName, aColors)
  [206] pushint8 1
  [208] getlocal 3
  [210] add
  [211] setlocal 3
  [213] endrepeat [ 47]
  [215] getlocal 0 .............................. <aFloorPatterns>
  [217] pusharglistnoret 1 ...................... <aFloorPatterns>
  [219] extcall 92 .............................. return aFloorPatterns
  [221] ret
end

on setPattern me, iPatternIndex, iColorIndex, iSprite
  [  0] getparam 0 .............................. <me>
  [  2] pushsymb 930 ............................ <#aPatterns>
  [  5] pusharglist 2 ........................... <me, #aPatterns>
  [  7] objcall 169 ............................. <me.aPatterns.count>
  [  9] pushzero ................................ <0>
  [ 10] eq ...................................... <me.aPatterns.count = 0>
  [ 11] jmpifz [ 18] ............................ if me.aPatterns.count = 0 then
  [ 14] pusharglistnoret 0 ...................... <>
  [ 16] extcall 92 .............................. return 
  [ 18] getparam 1 .............................. <iPatternIndex>
  [ 20] pusharglist 1 ........................... <iPatternIndex>
  [ 22] extcall 105 ............................. <voidp(iPatternIndex)>
  [ 24] jmpifz [ 31] ............................ if voidp(iPatternIndex) then
  [ 27] pushint8 1 .............................. <1>
  [ 29] setparam 1 .............................. iPatternIndex = 1
  [ 31] getparam 2 .............................. <iColorIndex>
  [ 33] pusharglist 1 ........................... <iColorIndex>
  [ 35] extcall 105 ............................. <voidp(iColorIndex)>
  [ 37] jmpifz [ 44] ............................ if voidp(iColorIndex) then
  [ 40] pushint8 1 .............................. <1>
  [ 42] setparam 2 .............................. iColorIndex = 1
  [ 44] getparam 1 .............................. <iPatternIndex>
  [ 46] pushint8 1 .............................. <1>
  [ 48] lt ...................................... <iPatternIndex < 1>
  [ 49] getparam 1 .............................. <iPatternIndex>
  [ 51] getparam 0 .............................. <me>
  [ 53] pushsymb 930 ............................ <#aPatterns>
  [ 56] pusharglist 2 ........................... <me, #aPatterns>
  [ 58] objcall 169 ............................. <me.aPatterns.count>
  [ 60] gt ...................................... <iPatternIndex > me.aPatterns.count>
  [ 61] or ...................................... <(iPatternIndex < 1) or (iPatternIndex > me.aPatterns.count)>
  [ 62] jmpifz [ 69] ............................ if (iPatternIndex < 1) or (iPatternIndex > me.aPatterns.count) then
  [ 65] pushint8 1 .............................. <1>
  [ 67] setparam 1 .............................. iPatternIndex = 1
  [ 69] getparam 0 .............................. <me>
  [ 71] getchainedprop 930 ...................... <me.aPatterns>
  [ 74] getparam 1 .............................. <iPatternIndex>
  [ 76] pusharglist 2 ........................... <me.aPatterns, iPatternIndex>
  [ 78] objcall 899 ............................. <me.aPatterns.getPropAt(iPatternIndex)>
  [ 81] setlocal 0 .............................. sPatternName = me.aPatterns.getPropAt(iPatternIndex)
  [ 83] getparam 0 .............................. <me>
  [ 85] pushsymb 930 ............................ <#aPatterns>
  [ 88] getparam 1 .............................. <iPatternIndex>
  [ 90] pusharglist 3 ........................... <me, #aPatterns, iPatternIndex>
  [ 92] objcall 577 ............................. <me.aPatterns[iPatternIndex]>
  [ 95] setlocal 1 .............................. aColors = me.aPatterns[iPatternIndex]
  [ 97] getparam 2 .............................. <iColorIndex>
  [ 99] pushint8 1 .............................. <1>
  [101] lt ...................................... <iColorIndex < 1>
  [102] getparam 2 .............................. <iColorIndex>
  [104] getlocal 1 .............................. <aColors>
  [106] getobjprop 169 .......................... <aColors.count>
  [108] gt ...................................... <iColorIndex > aColors.count>
  [109] or ...................................... <(iColorIndex < 1) or (iColorIndex > aColors.count)>
  [110] jmpifz [117] ............................ if (iColorIndex < 1) or (iColorIndex > aColors.count) then
  [113] pushint8 1 .............................. <1>
  [115] setparam 2 .............................. iColorIndex = 1
  [117] getlocal 1 .............................. <aColors>
  [119] getparam 2 .............................. <iColorIndex>
  [121] pusharglist 2 ........................... <aColors, iColorIndex>
  [123] objcall 196 ............................. <aColors[iColorIndex]>
  [125] setlocal 2 .............................. aColorData = aColors[iColorIndex]
  [127] getlocal 2 .............................. <aColorData>
  [129] pusharglist 0 ........................... <>
  [131] extcall 130 ............................. <VOID>
  [133] eq ...................................... <aColorData = VOID>
  [134] jmpifz [142] ............................ if aColorData = VOID then
  [137] pusharglistnoret 0 ...................... <>
  [139] extcall 797 ............................. nothing()
  [142] getparam 3 .............................. <iSprite>
  [144] getparam 0 .............................. <me>
  [146] getobjprop 931 .......................... <me.iShapeSprite>
  [149] eq ...................................... <iSprite = me.iShapeSprite>
  [150] jmpifz [173] ............................ if iSprite = me.iShapeSprite then
  [153] getparam 0 .............................. <me>
  [155] getlocal 0 .............................. <sPatternName>
  [157] getlocal 2 .............................. <aColorData>
  [159] getparam 0 .............................. <me>
  [161] getobjprop 931 .......................... <me.iShapeSprite>
  [164] pusharglistnoret 4 ...................... <me, sPatternName, aColorData, me.iShapeSprite>
  [166] objcall 927 ............................. me.displayShapePattern(sPatternName, aColorData, me.iShapeSprite)
  [169] pusharglistnoret 0 ...................... <>
  [171] extcall 92 .............................. return 
  [173] getparam 3 .............................. <iSprite>
  [175] pusharglist 1 ........................... <iSprite>
  [177] extcall 105 ............................. <voidp(iSprite)>
  [179] jmpifz [252] ............................ if voidp(iSprite) then / else
  [182] getparam 0 .............................. <me>
  [184] getlocal 0 .............................. <sPatternName>
  [186] getlocal 2 .............................. <aColorData>
  [188] getparam 0 .............................. <me>
  [190] getobjprop 931 .......................... <me.iShapeSprite>
  [193] pusharglistnoret 4 ...................... <me, sPatternName, aColorData, me.iShapeSprite>
  [195] objcall 927 ............................. me.displayShapePattern(sPatternName, aColorData, me.iShapeSprite)
  [198] getparam 0 .............................. <me>
  [200] getobjprop 932 .......................... <me.aTileSprites>
  [203] peek 0
  [205] pusharglist 1
  [207] extcall 169
  [209] pushint8 1
  [211] peek 0
  [213] peek 2
  [215] lteq
  [216] jmpifz [247] ............................ repeat with i in me.aTileSprites
  [219] peek 2
  [221] peek 1
  [223] pusharglist 2
  [225] extcall 196
  [227] setlocal 3
  [229] getparam 0 .............................. <me>
  [231] getlocal 0 .............................. <sPatternName>
  [233] getlocal 2 .............................. <aColorData>
  [235] getlocal 3 .............................. <i>
  [237] pusharglistnoret 4 ...................... <me, sPatternName, aColorData, i>
  [239] objcall 928 ............................. me.displayPattern(sPatternName, aColorData, i)
  [242] pushint8 1
  [244] add
  [245] endrepeat [211]
  [247] pop 3
  [249] jmp [265]
  [252] getparam 0 .............................. <me>
  [254] getlocal 0 .............................. <sPatternName>
  [256] getlocal 2 .............................. <aColorData>
  [258] getparam 3 .............................. <iSprite>
  [260] pusharglistnoret 4 ...................... <me, sPatternName, aColorData, iSprite>
  [262] objcall 928 ............................. me.displayPattern(sPatternName, aColorData, iSprite)
  [265] ret
end

on displayShapePattern me, sPatternName, aColorData, iSprite
  [  0] getparam 3 .............................. <iSprite>
  [  2] pusharglist 1 ........................... <iSprite>
  [  4] extcall 451 ............................. <sprite(iSprite)>
  [  7] getchainedprop 454 ...................... <sprite(iSprite).member>
  [ 10] getparam 2 .............................. <aColorData>
  [ 12] getobjprop 958 .......................... <aColorData.startcolor>
  [ 15] setobjprop 959 .......................... sprite(iSprite).member.fillColor = aColorData.startcolor
  [ 18] getparam 3 .............................. <iSprite>
  [ 20] pusharglist 1 ........................... <iSprite>
  [ 22] extcall 451 ............................. <sprite(iSprite)>
  [ 25] getchainedprop 454 ...................... <sprite(iSprite).member>
  [ 28] getparam 2 .............................. <aColorData>
  [ 30] getobjprop 960 .......................... <aColorData.endColor>
  [ 33] setobjprop 960 .......................... sprite(iSprite).member.endColor = aColorData.endColor
  [ 36] getparam 3 .............................. <iSprite>
  [ 38] pusharglist 1 ........................... <iSprite>
  [ 40] extcall 451 ............................. <sprite(iSprite)>
  [ 43] getparam 2 .............................. <aColorData>
  [ 45] getobjprop 961 .......................... <aColorData.shapeBlend>
  [ 48] setobjprop 463 .......................... sprite(iSprite).blend = aColorData.shapeBlend
  [ 51] getparam 3 .............................. <iSprite>
  [ 53] pusharglist 1 ........................... <iSprite>
  [ 55] extcall 451 ............................. <sprite(iSprite)>
  [ 58] getparam 2 .............................. <aColorData>
  [ 60] getobjprop 962 .......................... <aColorData.texturecolor>
  [ 63] setobjprop 494 .......................... sprite(iSprite).color = aColorData.texturecolor
  [ 66] ret
end

on displayPattern me, sPatternName, aColorData, iSprite
  [  0] getparam 3 .............................. <iSprite>
  [  2] pusharglist 1 ........................... <iSprite>
  [  4] extcall 451 ............................. <sprite(iSprite)>
  [  7] getchainedprop 454 ...................... <sprite(iSprite).member>
  [ 10] pushcons 7 .............................. <"floor_">
  [ 12] getparam 2 .............................. <aColorData>
  [ 14] getobjprop 607 .......................... <aColorData.palette>
  [ 17] joinstr ................................. <"floor_" & aColorData.palette>
  [ 18] getparam 0 .............................. <me>
  [ 20] getobjprop 253 .......................... <me.sCastLib>
  [ 22] pusharglist 2 ........................... <"floor_" & aColorData.palette, me.sCastLib>
  [ 24] extcall 454 ............................. <member("floor_" & aColorData.palette, me.sCastLib)>
  [ 27] setobjprop 607 .......................... sprite(iSprite).member.palette = member("floor_" & aColorData.palette, me.sCastLib)
  [ 30] getparam 3 .............................. <iSprite>
  [ 32] pusharglist 1 ........................... <iSprite>
  [ 34] extcall 451 ............................. <sprite(iSprite)>
  [ 37] getparam 2 .............................. <aColorData>
  [ 39] getobjprop 963 .......................... <aColorData.textureBlend>
  [ 42] setobjprop 463 .......................... sprite(iSprite).blend = aColorData.textureBlend
  [ 45] ret
end

on setRandomPattern me
  [  0] getparam 0 .............................. <me>
  [  2] pushsymb 930 ............................ <#aPatterns>
  [  5] pusharglist 2 ........................... <me, #aPatterns>
  [  7] objcall 169 ............................. <me.aPatterns.count>
  [  9] pusharglist 1 ........................... <me.aPatterns.count>
  [ 11] extcall 469 ............................. <random(me.aPatterns.count)>
  [ 14] setlocal 0 .............................. iPatternIndex = random(me.aPatterns.count)
  [ 16] getparam 0 .............................. <me>
  [ 18] pushsymb 930 ............................ <#aPatterns>
  [ 21] getlocal 0 .............................. <iPatternIndex>
  [ 23] pusharglist 3 ........................... <me, #aPatterns, iPatternIndex>
  [ 25] objcall 577 ............................. <me.aPatterns[iPatternIndex]>
  [ 28] setlocal 1 .............................. aColors = me.aPatterns[iPatternIndex]
  [ 30] getlocal 1 .............................. <aColors>
  [ 32] getobjprop 169 .......................... <aColors.count>
  [ 34] pusharglist 1 ........................... <aColors.count>
  [ 36] extcall 469 ............................. <random(aColors.count)>
  [ 39] setlocal 2 .............................. iColorIndex = random(aColors.count)
  [ 41] getparam 0 .............................. <me>
  [ 43] getlocal 0 .............................. <iPatternIndex>
  [ 45] getlocal 2 .............................. <iColorIndex>
  [ 47] pusharglistnoret 3 ...................... <me, iPatternIndex, iColorIndex>
  [ 49] objcall 926 ............................. me.setPattern(iPatternIndex, iColorIndex)
  [ 52] ret
end
